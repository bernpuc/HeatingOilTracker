<UserControl x:Class="HeatingOilTracker.Views.DeliveriesView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:prism="http://prismlibrary.com/"
             prism:ViewModelLocator.AutoWireViewModel="True"
             Background="White">
    <DockPanel Margin="20">
        <!-- Header / Toolbar -->
        <DockPanel DockPanel.Dock="Top" Margin="0,0,0,15">
            <TextBlock Text="Deliveries"
                       FontSize="24" FontWeight="Bold"
                       Foreground="#1e293b"
                       VerticalAlignment="Center"/>

            <StackPanel Orientation="Horizontal"
                        HorizontalAlignment="Right"
                        DockPanel.Dock="Right">
                <Button Content="Add"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Command="{Binding AddCommand}"
                        Margin="0,0,8,0"/>
                <Button Content="Edit"
                        Style="{StaticResource SecondaryButtonStyle}"
                        Command="{Binding EditCommand}"
                        Margin="0,0,8,0"/>
                <Button Content="Delete"
                        Style="{StaticResource DangerButtonStyle}"
                        Command="{Binding DeleteCommand}"
                        Margin="0,0,16,0"/>
                <Button Content="Import CSV"
                        Style="{StaticResource SecondaryButtonStyle}"
                        Command="{Binding ImportCommand}"
                        Margin="0,0,8,0"/>
                <Button Content="Export CSV"
                        Style="{StaticResource SecondaryButtonStyle}"
                        Command="{Binding ExportCommand}"/>
            </StackPanel>
        </DockPanel>

        <!-- Summary Footer -->
        <Border DockPanel.Dock="Bottom"
                Background="#f8fafc"
                BorderBrush="{StaticResource BorderColor}"
                BorderThickness="1"
                CornerRadius="6"
                Padding="15,10"
                Margin="0,15,0,0">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding TotalDeliveriesText}"
                           FontWeight="SemiBold" Margin="0,0,30,0"/>
                <TextBlock Text="{Binding AveragePriceText}"
                           Margin="0,0,30,0"/>
                <TextBlock Text="{Binding AverageBurnRateText}"/>
            </StackPanel>
        </Border>

        <!-- Empty State -->
        <TextBlock Text="No deliveries yet. Click 'Add' to record your first delivery."
                   FontSize="16" Foreground="#94a3b8"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   Visibility="{Binding HasDeliveries, Converter={StaticResource InverseBoolToVisibility}}"/>

        <!-- DataGrid -->
        <DataGrid ItemsSource="{Binding Deliveries}"
                  SelectedItem="{Binding SelectedDelivery}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  CanUserReorderColumns="False"
                  CanUserResizeRows="False"
                  SelectionMode="Single"
                  GridLinesVisibility="Horizontal"
                  HorizontalGridLinesBrush="{StaticResource BorderColor}"
                  HeadersVisibility="Column"
                  CanUserSortColumns="True">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Date"
                                    Binding="{Binding Date, StringFormat=\{0:MM/dd/yyyy\}}"
                                    Width="110"
                                    SortDirection="Descending"/>
                <DataGridTextColumn Header="Gallons"
                                    Binding="{Binding Gallons, StringFormat=\{0:F1\}}"
                                    Width="90">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                            <Setter Property="Padding" Value="0,0,10,0"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="$/Gal"
                                    Binding="{Binding PricePerGallon, StringFormat=\{0:F3\}}"
                                    Width="80">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                            <Setter Property="Padding" Value="0,0,10,0"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Total Cost"
                                    Binding="{Binding TotalCost, StringFormat=\{0:C2\}}"
                                    Width="100">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right"/>
                            <Setter Property="Padding" Value="0,0,10,0"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Days Since Last"
                                    Binding="{Binding DaysSinceLastFillDisplay}"
                                    Width="110">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Center"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Gal/Day"
                                    Binding="{Binding GallonsPerDayDisplay}"
                                    Width="80">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Center"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Notes"
                                    Binding="{Binding Notes}"
                                    Width="*"/>
            </DataGrid.Columns>
        </DataGrid>
    </DockPanel>
</UserControl>
